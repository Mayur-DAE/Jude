<!-- Modal starts -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">{{ ModalTitle }}</h5>
        <button type="button" class="btn btn-primary btn-rounded btn-icon" data-bs-dismiss="modal" aria-label="Close"
          (click)="closeClick()">
          <i class="ti-close"></i>  
        </button>
      </div>
      <app-add-edit-company [company]="company" (emitData)="emittedDataByChild($event)" *ngIf="ActivateAddEditfaq">
      </app-add-edit-company>
    </div>
  </div>
</div>
<!-- Modal Ends -->


<div class="card">
  <div class="card-body">
    <h4 class="card-title">Shop List</h4>
    <div class="row">
      <div class="col-12">
        <div class="text-left">
          <button type="button" class="btn btn-primary btn-icon-text plus" *ngIf="UserRoleID != 2" (click)="addClick()"
            data-bs-toggle="modal" data-bs-target="#exampleModal" >
            <i class="ti-plus"></i> Add
          </button>
        </div>
        <br />
        <!-- <br /> -->
        <div class="col-sm-12 row">

          <div class="col-3" *ngIf="UserRoleID != 2">
            <div class="form-group">
              <label for="exampleInputUsername1">Shop Name</label>
              <input type="text" class="form-control uniform-input " id="exampleInputUsername1" placeholder="Shop Name"
                name="firstName" (keydown.enter)='refreshCompanyList()' [(ngModel)]="CompanyNameSearch" />
            </div>
          </div>

          <div class="col-3" *ngIf="UserRoleID != 2">
            <div class="form-group">
              <label for="exampleInputUsername1">Business Type:</label>
              <select class="form-select uniform-input" [(ngModel)]="BusinessTypeID">
                <option disabled selected>--Select--</option>
                <option *ngFor="let x of BusinessTypeList" [value]="x.BusinessTypeID">
                  {{ x.BusinessTypeName }}
                </option>
              </select>
            </div>
          </div>

          <div class="col-3" *ngIf="UserRoleID != 2">
            <div class="form-group">
              <label for="exampleInputUsername1">Shop Membership Type:</label>
              <select class="form-select uniform-input " [(ngModel)]="CompanyMemberShipTypeID">
                <option disabled selected>--Select--</option>
                <option *ngFor="let x of CompanymembershipnameList" [value]="x.CompanyMemberShipTypeID">
                  {{ x.CompanyMemberShipName }}
                </option>
              </select>
            </div>
          </div>
          <div class="col-12 col-md-3 " style="margin-top: 1rem;margin-bottom: 1rem;" *ngIf="UserRoleID != 2">
            <div class="d-flex flex-wrap align-items-center">
              
              <!-- Expired Shops Checkbox -->
              <div class="col-12 col-md-4 mb-2 mb-md-0">
                <label class="form-check-label">
                  <input type="checkbox" [(ngModel)]="isExpiredShops" (change)="checkExpire()" />
                  <span style="font-size: 0.875rem; line-height: 1.4rem; margin-left: 0.5rem; ">Expired Shops</span>
                </label>
              </div>
          
              <!-- Buttons Container (Inline & Small) -->
              <div class="col-12 col-md-8 d-flex justify-content-md-end gap-2">
                <button *ngIf="UserRoleID != 2" type="submit" class="btn btn-primary btn-sm w-100 w-md-auto"
                style="height: 40px;"
                  (click)="refreshCompanyList()">
                  Search
                </button>
                
                <button *ngIf="UserRoleID != 2" type="button" class="btn btn-secondary btn-sm w-100 w-md-auto"
                style="height: 40px;"
                  (click)="clearSearchFields()">
                  Clear
                </button>
              </div>
          
            </div>
          </div>
          <div class="row mb-4 mt-2">
            <div class="col-md-6 col-sm-12 d-flex align-items-center mt-sm-2">
              <label for="itemsPerPage" class="mr-2">Items per page:&nbsp;</label>
              <select id="itemsPerPage" class="border rounded px-2 py-1" (change)="onItemsPerPageChange($event)">
                <option value="5" [selected]="itemsPerPage === 5">5</option>
                <option value="10" [selected]="itemsPerPage === 10">10</option>
                <option value="20" [selected]="itemsPerPage === 20">20</option>
                <option value="30" [selected]="itemsPerPage === 30">30</option>
              </select>
            </div>
            <div class="col-md-6 col-sm-12 d-flex justify-content-end mb-sm-2" style="padding: 0px !important;">
              <button type="button" class="export-btn btn fa fa-file-excel-o excelbutton mt-2 md:mt-0" (click)="exportToExcel()" style="padding: 0px !important;">
                <i class="ti-file me-1"></i>Export to Excel
              </button>
            </div>
          </div>          
          <br />

          <div class="table-responsive">
            <table id="show-company" class="table">
              <thead>
                <tr class="bg-primary text-white">
                  <th>Sr no</th>
                  <th>Name</th>
                  <th>Business Type</th>
                  <th>Membership Type</th>
                  <th>Expiry Date</th>
                  <th style="text-align: center;">Status</th>
                  <th style="text-align: center;">Action</th>
                </tr>
              </thead>
              <tbody>
                 <tr *ngIf="companyList.length == 0">
                <td colspan="7" class="text-center">No records found</td>
              </tr>
                <tr *ngFor="
                    let dataItem of paginatedCompany;
                    let i = index;
                    let last = last
                  ">
                  <td style="width: 70px;">{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
                  <td class="Companyname">{{ dataItem.CompanyName }}</td>
                  <td class="BusinessType">{{ dataItem.BusinessTypeName }}</td>
                  <td>{{ dataItem.CompanyMemberShipName }}</td>
                  <td>{{ dataItem.CompanyMemberShipExpiryDate }}</td>
                  <td style="width: 70px;">
                    <label class="btn btn-outline-info btn-fw p-2"
                      *ngIf="UserRoleID == 2 && dataItem.IsActive">Active</label>
                    <label class="btn btn-outline-danger btn-fw p-2"
                      *ngIf="UserRoleID == 2 && !dataItem.IsActive">Inactive</label>
                    <button type="button" class="btn btn-outline-info btn-fw p-2"
                      *ngIf="dataItem.IsActive && UserRoleID != 2" (click)="activeClick(dataItem)">
                      Active
                    </button>
                    <button type="button" class="btn btn-outline-danger btn-fw p-2"
                      *ngIf="!dataItem.IsActive && UserRoleID != 2" (click)="inactiveClick(dataItem)">
                      Inactive
                    </button>
                  </td>
                  <td style="width: 70px;">
                    <button type="button" id="edit-btn" class="btn btn-light" (click)="editClick(dataItem)"
                      data-bs-toggle="modal" data-bs-target="#exampleModal" data-whatever="@getbootstrap">
                      <i class="ti-pencil"></i> Edit
                    </button>
                  </td>
                  {{last ? openModal() : ''}}
                </tr>
              </tbody>
            </table>
          </div>
       
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mt-3 px-3 px-md-4">
          <span class="text-muted mb-2 mb-md-0">
            Showing 
            {{ (currentPage - 1) * itemsPerPage + 1 }} 
            to 
            {{ min(currentPage * itemsPerPage, companyList.length) }} 
            of 
            {{ companyList.length }} entries
          </span>
       
          <nav>
            <ul class="pagination mb-0">
              <!-- Previous Button -->
              <li class="page-item" [class.disabled]="currentPage === 1">
                <a class="page-link" (click)="changePage(currentPage - 1)"><<</a>
              </li>
          
              <!-- Page 1 -->
              <li class="page-item" [class.active]="currentPage === 1">
                <a class="page-link" (click)="changePage(1)">1</a>
              </li>
          
              <!-- Ellipsis before middle pages -->
              <li class="page-item disabled" *ngIf="getMiddlePages()[0] > 2">
                <span class="page-link">...</span>
              </li>
          
              <!-- Middle Pages -->
              <ng-container *ngFor="let page of getMiddlePages()">
                <li class="page-item" [class.active]="currentPage === page">
                  <a class="page-link" (click)="changePage(page)">{{ page }}</a>
                </li>
              </ng-container>
          
              <!-- Ellipsis after middle pages -->
              <li class="page-item disabled" *ngIf="getMiddlePages().includes(totalPages - 1) === false && totalPages > 5">
                <span class="page-link">...</span>
              </li>
          
              <!-- Last Page -->
              <li class="page-item" *ngIf="totalPages > 1" [class.active]="currentPage === totalPages">
                <a class="page-link" (click)="changePage(totalPages)">{{ totalPages }}</a>
              </li>
          
              <!-- Next Button -->
              <li class="page-item" [class.disabled]="currentPage === totalPages">
                <a class="page-link" (click)="changePage(currentPage + 1)">>></a>
              </li>
            </ul>
          </nav>
          
        </div>
   
        </div>
      </div>
    </div>
  </div>
</div>